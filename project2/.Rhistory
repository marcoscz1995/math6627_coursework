setwd("~/Documents/YorkU_Courses/MATH6627_Stats_Consulting/math6627_coursework/project2")
########
####import weights
#simple models
normal_popularity <- readRDS("model_weights/normal_popularity.RDS")
pois_views_tfidf <-
readRDS("model_weights/pois_views_simple_tfidf.RDS")
#mixed models themes
pois_views_themes_0 <-
readRDS("model_weights/pois_views_themes_0.RDS")
pois_views_themes_1 <-
readRDS("model_weights/pois_views_themes_1.RDS")
pois_views_themes_2 <-
readRDS("model_weights/pois_views_themes_2.RDS")
normal_popularity_themes_0 <-
readRDS("model_weights/normal_popularity_themes_0.RDS")
normal_popularity_themes_1 <-
readRDS("model_weights/normal_popularity_themes_1.RDS")
normal_popularity_themes_2 <-
readRDS("model_weights/normal_popularity_themes_2.RDS")
#mixed models times
pois_views_times_0 <-
readRDS("model_weights/pois_views_times_0.RDS")
pois_views_times_1 <-
readRDS("model_weights/pois_views_times_1.RDS")
pois_views_times_2 <-
readRDS("model_weights/pois_views_times_2.RDS")
normal_popularity_times_0 <-
readRDS("model_weights/normal_popularity_times_0.RDS")
normal_popularity_times_1 <-
readRDS("model_weights/normal_popularity_times_1.RDS")
normal_popularity_times_2 <-
readRDS("model_weights/normal_popularity_times_2.RDS")
summary(pois_views_times_2)
df <- read.csv("data/cleaned_data.csv")
attach(df)
#response: avg views per day
#using kmeans with tfidf to determine the sentiment of the video title
pois_views_tfidf <-
glm(
avg_views_per_day ~ duration + num_speaker + film_age+title_sentiment_tfidf +title_length+ tags_label_tfidf+video_age_label,
family = poisson(link = log)
)
summary(pois_views_tfidf)
#Linear model
#response: composite popularity score (includes languages, standardized comments,
# standardized views,aggregate ratings, number of related talks)
normal_popularity <-
lm(popularity ~ duration + num_speaker+title_sentiment_tfidf + title_length+film_age + tags_label_tfidf+video_age_label)
summary(normal_popularity)
saveRDS(normal_popularity, "model_weights/normal_popularity.RDS")
saveRDS(pois_views_tfidf, "model_weights/pois_views_simple_tfidf.RDS")
#Poisson models
pois_views_times_0 <-
glm(
avg_views_per_day ~ duration + num_speaker+ title_length+title_sentiment_tfidf + film_age,
data = df,
family = poisson(link = log)
)
summary(pois_views_times_0)
#only random intercept
pois_views_times_1 <-
glmer(
avg_views_per_day ~ duration + title_length+title_sentiment_tfidf+ num_speaker + film_age + (1 |
video_age_label),
data = df,
family = poisson(link = log)
)
library(lme4)
#Poisson models
pois_views_times_0 <-
glm(
avg_views_per_day ~ duration + num_speaker+ title_length+title_sentiment_tfidf + film_age,
data = df,
family = poisson(link = log)
)
summary(pois_views_times_0)
#only random intercept
pois_views_times_1 <-
glmer(
avg_views_per_day ~ duration + title_length+title_sentiment_tfidf+ num_speaker + film_age + (1 |
video_age_label),
data = df,
family = poisson(link = log)
)
summary(pois_views_times_1)
#random intercept and slope
pois_views_times_2 <-
glmer(
avg_views_per_day ~ duration+ title_length+title_sentiment_tfidf + num_speaker + film_age + (1 + duration + num_speaker + film_age+ title_length+title_sentiment_tfidf |
video_age_label),
data = df,
family = poisson(link = log)
)
summary(pois_views_times_2)
#save the weights
saveRDS(pois_views_times_0, "model_weights/pois_views_times_0.RDS")
saveRDS(pois_views_times_1, "model_weights/pois_views_times_1.RDS")
saveRDS(pois_views_times_2, "model_weights/pois_views_times_2.RDS")
######Normal models on popularity score
#no randomness
normal_popularity_times_0 <-
lm(
popularity ~ duration + title_length+title_sentiment_tfidf+ num_speaker + film_age,
data = df
)
summary(normal_popularity_times_0)
#only random intercept
normal_popularity_times_1 <-
lmer(
popularity ~ duration + title_length+title_sentiment_tfidf+ num_speaker + film_age + (1 |
video_age_label),
data = df
)
summary(normal_popularity_times_1)
#random intercept and slope
normal_popularity_times_2 <-
lmer(
popularity ~ duration + title_length+title_sentiment_tfidf+ num_speaker + film_age + (1 + duration + num_speaker + film_age |
video_age_label),
data = df
)
summary(normal_popularity_times_2)
#save the weights
saveRDS(normal_popularity_times_0, "model_weights/normal_popularity_times_0.RDS")
saveRDS(normal_popularity_times_1, "model_weights/normal_popularity_times_1.RDS")
saveRDS(normal_popularity_times_2, "model_weights/normal_popularity_times_2.RDS")
source("latex_tables_makers/longtablestargazer.R")
require(stargazer)
library(xtable)
library(reporttools)
df <- read.csv("data/cleaned_data.csv")
########
####import weights
#simple models
normal_popularity <- readRDS("model_weights/normal_popularity.RDS")
pois_views_tfidf <-
readRDS("model_weights/pois_views_simple_tfidf.RDS")
#mixed models themes
pois_views_themes_0 <-
readRDS("model_weights/pois_views_themes_0.RDS")
pois_views_themes_1 <-
readRDS("model_weights/pois_views_themes_1.RDS")
pois_views_themes_2 <-
readRDS("model_weights/pois_views_themes_2.RDS")
normal_popularity_themes_0 <-
readRDS("model_weights/normal_popularity_themes_0.RDS")
normal_popularity_themes_1 <-
readRDS("model_weights/normal_popularity_themes_1.RDS")
normal_popularity_themes_2 <-
readRDS("model_weights/normal_popularity_themes_2.RDS")
#mixed models times
pois_views_times_0 <-
readRDS("model_weights/pois_views_times_0.RDS")
pois_views_times_1 <-
readRDS("model_weights/pois_views_times_1.RDS")
pois_views_times_2 <-
readRDS("model_weights/pois_views_times_2.RDS")
normal_popularity_times_0 <-
readRDS("model_weights/normal_popularity_times_0.RDS")
normal_popularity_times_1 <-
readRDS("model_weights/normal_popularity_times_1.RDS")
normal_popularity_times_2 <-
readRDS("model_weights/normal_popularity_times_2.RDS")
#we only want untransformed variables ie those not normalized
df_categorical <-
df[, c("title_sentiment_tfidf", "tags_label_tfidf", "video_age_label")]
df_numeric <-
df[, c(
"avg_views_per_day",
"duration_no_norm",
"num_speaker_no_norm",
"film_age_no_norm",
"title_length_no_norm",
"popularity"
)]
######
#sumarize numeric variables
###
sink("report/tables/numeric_variables_description.tex")
print(tableContinuous(df_numeric))
#sumarize categorical variables
sink("report/tables/descriptive_stats/categorical_variables_description.tex")
print(tableNominal(df_categorical)) #adds the table to the text file
#####
#anova tables
#these test the random slope
sink("report/tables/anova/nova_pois_themes.tex")
print(xtable(anova(
pois_views_themes_1, pois_views_themes_2
)))
sink("report/tables/anova/nova_pois_times.tex")
print(xtable(anova(pois_views_times_1, pois_views_times_2)))
#####
#anova tables
#these test the random slope
sink("report/tables/anova/anova_pois_themes.tex")
print(xtable(anova(
pois_views_themes_1, pois_views_themes_2
)))
sink("report/tables/anova/anova_pois_times.tex")
print(xtable(anova(pois_views_times_1, pois_views_times_2)))
sink("report/tables/anova/anova_normal_popularity_themes.tex")
print(xtable(
anova(normal_popularity_themes_1, normal_popularity_themes_2)
))
sink("report/tables/anova/anova_normal_popularity_times.tex")
print(xtable(anova(
normal_popularity_times_1, normal_popularity_times_2
)))
#####
#AIC tables
#these test random intercept
sink("report/tables/aic/aic_pois_themes.tex")
print(xtable(AIC(
pois_views_themes_0, pois_views_themes_1
)))
sink("report/tables/aic/aic_pois_times.tex")
print(xtable(AIC(pois_views_times_0, pois_views_times_1)))
sink("report/tables/aic/aic_normal_popularity_themes.tex")
print(xtable(AIC(
normal_popularity_themes_0, normal_popularity_themes_1
)))
sink("report/tables/aic/aic_normal_popularity_times.tex")
print(xtable(AIC(
normal_popularity_times_0, normal_popularity_times_1
)))
#Poisson models
pois_views_times_0 <-
glm(
avg_views_per_day ~ duration + num_speaker+ title_length+title_sentiment_tfidf + film_age,
data = df,
family = poisson(link = log)
)
summary(pois_views_times_0)
#only random intercept
pois_views_times_1 <-
glmer(
avg_views_per_day ~ duration + title_length+title_sentiment_tfidf+ num_speaker + film_age + (1 |
video_age_label),
data = df,
family = poisson(link = log)
)
summary(pois_views_times_1)
